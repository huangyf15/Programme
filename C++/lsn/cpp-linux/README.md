# 学习笔记

## 第十一讲：泛型编程

* 动机
	* 函数重载问题
		* 需要一种机制，能够在语法层面解决宏的问题
	* 相似类定义问题
		* 需要一种机制，能够在语法层面解决相似类的重复定义问题，降低编程工作量
	* 型式兼容性问题
		* 目标：需要一种机制，能够
			* 确保型式转换操作合法有效，并在失败时通知用户
			* 维持对象的运行期型式信息(run-time type information, RTTI)
			* 转换结果确认，即通过转换操作的返回值确认结果，或者在失败时触发特定信号；后者需要使用异常处理机制
		* 实现策略：模板与型式参数化

## 第十二讲：Linux 系统编程基础

* 程序运行环境
	* 资源管理
		* 必须予以明确管理的资源类型
			* 内存、文件描述符、文件指针、临时文件、同步对象等
		* 资源管理流程
			* Step 1: 分配资源
			* Step 2: 正常处理流程
			* Step 3: 如果流程失败，释放资源并退出，否则执行正常处理流程
			* Step 4: 释放资源
			* Step 5: 函数返回
	* 系统日志
		* 进程名称：rsyslogd，属于守护进程 (daemon)
		* 常见函数
			* syslog(): 日志生成函数，头文件为 "syslog.h"
			* openlog(): 日志打开函数
			* setlogmask(): 日志过滤函数
			* closelog(): 日志关闭函数
		* 用户信息
			* UID, GID: 真实用户(组) ID
			* EUID, EGID: 有效用户(组) ID
* 输入输出、文件与设备
	* 基本输入输出
		* 标准输入输出流
		* 文件描述符
		* I/O 函数
	* 临时文件
		* 注意事项
			* 程序多个进程可能同时进行，它们应使用不同的临时文件
			* 必须小心设置文件属性，未授权用户不应具有临时文件访问权限
			* 临时文件的生成应该外部不可预测，否则系统容易受到攻击
		* 常见函数
			* mkstemp()：临时文件函数
			* unlink(): 将文件从目录项中删除，但文件本身仍存在
	* 文件系统
		* 分类
			* 实际文件系统：ext4
				* 组成：引导块、超级块、索引结点区、数据区
			* 虚拟文件系统：VFS
				* 特点：只存于内存中，充当实际文件系统与操作系统之间的接口，提供实际文件系统的挂载，并管理实际文件系统
				* 意义：支持多种不同的文件系统，内核以一致的方式处理这些文件系统，从而对用户透明
			* 特殊文件系统：/proc
				* 特点：Linux 内核的窗口，只存于内存中，并不占用磁盘空间
				* 典型信息：进程信息、硬件信息、内核信息、设备、挂载点与文件系统
	* 设备
		* 性质：不是普通的磁盘文件，其上的数据需要与相应的设备驱动器通信
		* 类型：字符设备、块设备
		* 目录及特殊设备
			* 设备根目录: /dev
			* 哑设备: /dev/null
			* 零设备: /dev/zero
			* 满设备: /dev/full
			* 随机数设备: /dev/random, /dev/urandom
		* 设备访问与控制：像文件一样操作设备
* 库
	* 静态库（Archives）
		* 后缀名为 "*.a"
	* 动态库 (Shared Object)
		* 共享目标库：类似于 Windows 的 DLL，后缀一般为 "*.so"
		* 编译命令：g++ -shared -fPIC -o libtest.so test1.o test2.o
		* PIC (Position-Independent Code): 位置无关代码
	* 库的相关性
		* 独立库链接（如 libtiff 库要使用 libjpeg 和 libz 库）: g++ -static -o tifftest tifftest.c -ltiff -ljpeg -lz
		* 相关库链接（如 liba 与 libb 互相交叉引用）：g++ -o app app.o -la -lb -la
	* 混合 C/C++ 编程
		* 如果以 C++ 为主，则 C 的函数应封装于 extern "C" { ... } 块中，确保名解析正确工作（C 不支持函数重载）；反之亦然
* makefile
	* commands: 命令
		* 语法：由一行或多行 shell 命令，命令前必须用 Tab 开头
		* 作用：指示如何建构目标，一般为生成目标文件
		* 注意事项
			* 多条命令：每行命令都在单独的进程中执行，彼此没有继承关系，不能简单传递数据；解决方法是，用分号将多条命令书写在单行，此时可用 "\" 折行，或者为该条规则添加指示 ".ONESHELL: "
			* 伪目标：添加指示 ".PHONY: "，用于说明是操作名称，不是文件名，以防止 make 进行与该操作重名文件的文件检查，而是指示直接执行对应的命令；一般放在 makefile 文件末尾
