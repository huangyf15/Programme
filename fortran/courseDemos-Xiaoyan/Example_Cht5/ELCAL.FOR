      SUBROUTINE ELCAL(COORD,LNODS,XYZ_LOCAL,MATNO,PROPS,NTYPE,
     *				     NBD,QTAH,NHL,LL8,LL9,
     *                 NPOIN,NELEM,NNODE,NMATS,
     *                 NPROP,NEVAB,NEO,NEO_RIJ)
C*******************************************************C
C *** ELEMENT LIBRARY                                   C
C*******************************************************C
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION COORD(NPOIN,3),MATNO(NELEM),NTYPE(NELEM),
     *  LNODS(NELEM,NNODE),PROPS(NMATS,NPROP),XYZ_LOCAL(NELEM,3)
CCCCCCCCCCC    CHANGE
      DIMENSION NBD(LL8),QTAH(4,LL8),NHL(4,LL9)
DYDYDY! MODIFY :     DIMENSION NEL(23,5000)
      DIMENSION NEL(14)

      DO 70 IELEM=1,NELEM
           NEL(1)=NTYPE(IELEM)
           NEL(2)=MATNO(IELEM)
           DO J=1,NNODE
           NEL(J+2)=LNODS(IELEM,J)
           END DO
C *** THREE-TEMPRATURE DIMENSIONAL BLOCK ELEMENT
      IF(NTYPE(IELEM).EQ.751) THEN
DYDY  CIRCLE THIN WALL BEAM
         CALL TELE_BEAM_C0(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

      ELSE IF(NTYPE(IELEM).EQ.771) THEN
DYDY  SPECAL quadrilateral THIN WALL BEAM
         CALL TELE_BEAM_QU0(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

      ELSE IF(NTYPE(IELEM).EQ.781) THEN
DYDY OPEN CIRCLE THIN WALL BEAM
         CALL TELE_BEAM_C0(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  SQUARE THIN WALL BEAM
	ELSE IF(NTYPE(IELEM).EQ.752) THEN
         CALL TELE_BEAM_S0(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  CIRCLE FILLED BEAM
	ELSE IF(NTYPE(IELEM).EQ.753) THEN
         CALL TELE_BEAM_CF(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  CIRCLE HOLLOW BEAM (NO DISTURBANCE TEMPERATURE)
	ELSE IF(NTYPE(IELEM).EQ.754) THEN
         CALL TELE_BEAM_CF1(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  SQUARE FILL BEAM 
	ELSE IF(NTYPE(IELEM).EQ.755) THEN
         CALL TELE_BEAM_SF(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  SQUARE FILL BEAM for single joint
	ELSE IF(NTYPE(IELEM).EQ.756) THEN
         CALL TELE_BEAM_SF(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  CIRCLE HOLLOW BEAM (NO DISTURBANCE TEMPERATURE) for preload beam
	ELSE IF(NTYPE(IELEM).EQ.757) THEN
         CALL TELE_BEAM_CF1(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  SQUARE FILL BEAM 
	ELSE IF(NTYPE(IELEM).EQ.758) THEN
         CALL TELE_BEAM_SF(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)

DYDY  gongzi shape FILL BEAM 
	ELSE IF(NTYPE(IELEM).EQ.760) THEN
         CALL TELE_BEAM_GONG_F(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,
     *   COORD,PROPS,QTAH,NEL,NBD,NHL,XYZ_LOCAL,NEO,NEO_RIJ,NEVAB)
c xiang
	ELSE IF(NTYPE(IELEM).EQ.850) THEN
         CALL MEMBRANE_TK(NELEM,IELEM,NPOIN,NMATS,NPROP,LL8,LL9,COORD,
     *						  PROPS,QTAH,NEL,NHL,XYZ_LOCAL,NEO,NEO_RIJ)
           
      ELSE IF(NTYPE(IELEM).GE.8) THEN
C            GOTO 71     !!! exit loop  here !!!
DY	 READ(111,*) RHI,IELE,IFACE
DY       CALL HEATR(IELEM,NPOIN,NELEM
DY     1           ,COORD,NEL,NEO,IELE,IFACE,RHI)
      
      ELSE IF(NTYPE(IELEM).EQ.1) THEN
      END IF
 
 70   CONTINUE
      END
